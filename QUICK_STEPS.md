# ‚ö° –ë–´–°–¢–†–´–ï –®–ê–ì–ò –î–õ–Ø –í–´–ü–û–õ–ù–ï–ù–ò–Ø

## ‚úÖ –®–∞–≥ 1: –ù–∞–π—Ç–∏ twitchUserId (–ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò)

**–°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω!** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã—à–µ.

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ Prisma Studio:

```powershell
cd C:\Users\Admin\Downloads\drops\drops-crypto-api
npx prisma studio
```

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É **User**
2. –ù–∞–π–¥–∏—Ç–µ `twitchLogin = tiktak6828`
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `twitchUserId`

---

## ‚ö†Ô∏è –®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å ADMIN_TWITCH_IDS –≤ .env

**–°–∫—Ä–∏–ø—Ç –ø–æ–ø—ã—Ç–∞–ª—Å—è –¥–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª `.env`

**–ò–ª–∏ –≤—Ä—É—á–Ω—É—é:**

–û—Ç–∫—Ä–æ–π—Ç–µ: `C:\Users\Admin\Downloads\drops\drops-crypto-api\.env`

**–î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É:**
```env
ADMIN_TWITCH_IDS=–≤–∞—à_twitch_user_id
```

**–ù–∞–ø—Ä–∏–º–µ—Ä:**
```env
ADMIN_TWITCH_IDS=123456789
```

---

## ‚úÖ –®–∞–≥ 3: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å backend

**–û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–µ–∫—É—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å** (–µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω): **Ctrl + C**

**–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∑–∞–Ω–æ–≤–æ:**
```powershell
cd C:\Users\Admin\Downloads\drops\drops-crypto-api
npm run start:dev
```

**–î–æ–∂–¥–∏—Ç–µ—Å—å:** `Nest application successfully started`

---

## ‚ö†Ô∏è –®–∞–≥ 4: –ü–æ–ª—É—á–∏—Ç—å JWT —Ç–æ–∫–µ–Ω

**–í–∞—Ä–∏–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ OAuth (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)**

1. –û—Ç–∫—Ä–æ–π—Ç–µ: `http://localhost:3000/auth/twitch/start`
2. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å —á–µ—Ä–µ–∑ Twitch
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω –∏–∑:
   - Deep link: `dropscrypto://auth?token=...`
   - –ò–ª–∏ –∏–∑ SecureStore –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

**–í–∞—Ä–∏–∞–Ω—Ç B: –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω —É–∂–µ –µ—Å—Ç—å**

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π JWT —Ç–æ–∫–µ–Ω

**–í–∞—Ä–∏–∞–Ω—Ç C: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ª–æ–≥–∞—Ö/–ë–î**

–ï—Å–ª–∏ –≤—ã —É–∂–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–ª–∏—Å—å —Ä–∞–Ω–µ–µ, —Ç–æ–∫–µ–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∏–ª–∏ –ª–æ–≥–∞—Ö.

---

## ‚úÖ –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Admin Guard

**–ö–æ–≥–¥–∞ —É –≤–∞—Å –µ—Å—Ç—å JWT —Ç–æ–∫–µ–Ω:**

```powershell
cd C:\Users\Admin\Downloads\drops\drops-crypto-api
.\test-admin-guard.ps1 -Token "–í–ê–®_JWT_–¢–û–ö–ï–ù"
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è:**

‚úÖ **200 OK** ‚Üí Admin Guard —Ä–∞–±–æ—Ç–∞–µ—Ç, twitchUserId –≤ allowlist

‚ùå **403 Forbidden** ‚Üí –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
- ADMIN_TWITCH_IDS –ø—Ä–æ–ø–∏—Å–∞–Ω –≤ .env
- Backend –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
- twitchUserId –≤ —Ç–æ–∫–µ–Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å ADMIN_TWITCH_IDS

---

## ‚úÖ –®–∞–≥ 6: –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π claim

**–ö–æ–≥–¥–∞ —É –≤–∞—Å –µ—Å—Ç—å JWT —Ç–æ–∫–µ–Ω:**

```powershell
cd C:\Users\Admin\Downloads\drops\drops-crypto-api
.\create-test-claim.ps1 -Token "–í–ê–®_JWT_–¢–û–ö–ï–ù"
```

**–°–∫—Ä–∏–ø—Ç:**
- –ù–∞–π–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–π –ø—Ä–∏–∑ (–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Ä–≤—ã–π)
- –ü—Ä–æ–≤–µ—Ä–∏—Ç –Ω–∞–ª–∏—á–∏–µ –∫–æ—à–µ–ª—å–∫–∞
- –°–æ–∑–¥–∞—Å—Ç claim
- –ü–æ–∫–∞–∂–µ—Ç claimId –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–∏—Ö —Ç–µ—Å—Ç–æ–≤

**–ï—Å–ª–∏ –Ω–µ—Ç –ø—Ä–∏–∑–æ–≤:**
```powershell
cd drops-crypto-api
npm run prisma:seed
```

---

## üéØ –ß—Ç–æ –Ω–∞–ø–∏—Å–∞—Ç—å –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

**–ï—Å–ª–∏ –≤—Å—ë –ø—Ä–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ:**

```
–ù–∞—à—ë–ª twitchUserId, –ø—Ä–æ–ø–∏—Å–∞–ª ADMIN_TWITCH_IDS, admin-guard = 200, claim —Å–æ–∑–¥–∞–Ω (claimId=...)
```

**–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

- –ù–∞ –∫–∞–∫–æ–º —à–∞–≥–µ –æ—Å—Ç–∞–Ω–æ–≤–∏–ª–æ—Å—å (1-6)
- –¢–µ–∫—Å—Ç –æ—à–∏–±–∫–∏ –∏–∑ PowerShell
- –°–∫—Ä–∏–Ω—à–æ—Ç –æ—à–∏–±–∫–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)

---

## üìã –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å .env
```powershell
cd drops-crypto-api
Get-Content .env | Select-String "ADMIN_TWITCH_IDS"
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å backend
```
http://localhost:3000/health
```

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Admin Guard
```powershell
.\test-admin-guard.ps1 -Token "–≤–∞—à_—Ç–æ–∫–µ–Ω"
```

---

**–í—ã–ø–æ–ª–Ω–∏—Ç–µ —à–∞–≥–∏ 1-6 –∏ —Å–æ–æ–±—â–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç!** ‚úÖ
