# üîß –û–ë–ù–û–í–õ–ï–ù–ò–ï .env –§–ê–ô–õ–ê

## –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç–µ Client Secret –∏–∑ Twitch

1. –û—Ç–∫—Ä–æ–π—Ç–µ: https://dev.twitch.tv/console/apps
2. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (Client ID: `56h1oo23vmfsfcxpaf3gpi08cqlzyb`)
3. –ï—Å–ª–∏ **Client Secret** —Å–∫—Ä—ã—Ç ‚Äî –Ω–∞–∂–º–∏—Ç–µ **"New Secret"** –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –Ω–æ–≤—ã–π
4. ‚ö†Ô∏è **–í–ê–ñ–ù–û**: Client Secret –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑! –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –µ–≥–æ —Å—Ä–∞–∑—É.

---

## –®–∞–≥ 2: –û—Ç–∫—Ä–æ–π—Ç–µ .env —Ñ–∞–π–ª

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª:
```
C:\Users\Admin\Downloads\drops\drops-crypto-api\.env
```

---

## –®–∞–≥ 3: –û–±–Ω–æ–≤–∏—Ç–µ .env —Ñ–∞–π–ª

**–ó–∞–º–µ–Ω–∏—Ç–µ –≤—Å–µ —Å—Ç—Ä–æ–∫–∏** —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å Twitch –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ (–∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –æ—Ç–¥–µ–ª—å–Ω–æ):

```env
TWITCH_CLIENT_ID=56h1oo23vmfsfcxpaf3gpi08cqlzyb
TWITCH_CLIENT_SECRET=–í–ê–®_–†–ï–ê–õ–¨–ù–´–ô_CLIENT_SECRET_–ò–ó_TWITCH_CONSOLE
TWITCH_REDIRECT_URI=http://localhost:3000/auth/twitch/callback
PUBLIC_BASE_URL=http://localhost:3000
APP_DEEPLINK_SCHEME=dropscrypto
JWT_SECRET=–ª—é–±–∞—è_–¥–ª–∏–Ω–Ω–∞—è_—Å–ª—É—á–∞–π–Ω–∞—è_—Å—Ç—Ä–æ–∫–∞_–¥–ª—è_–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏_12345
```

**‚ö†Ô∏è –í–ê–ñ–ù–û:**
- –ö–∞–∂–¥–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–∞ **–æ—Ç–¥–µ–ª—å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ**
- **–ù–µ—Ç –ø—Ä–æ–±–µ–ª–æ–≤** –¥–æ –∏ –ø–æ—Å–ª–µ `=`
- **–ù–µ—Ç –∫–∞–≤—ã—á–µ–∫** –≤–æ–∫—Ä—É–≥ –∑–Ω–∞—á–µ–Ω–∏–π
- `TWITCH_CLIENT_SECRET` ‚Äî —ç—Ç–æ **—Ä–µ–∞–ª—å–Ω—ã–π Secret** –∏–∑ Twitch Console (–Ω–µ `your_twitch_client_secret_here`)

---

## –®–∞–≥ 4: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ backend

**–û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ** —Ç–µ–∫—É—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å (–µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω):
- –ù–∞–∂–º–∏—Ç–µ `Ctrl + C` –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, –≥–¥–µ –∑–∞–ø—É—â–µ–Ω backend

**–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∑–∞–Ω–æ–≤–æ:**
```powershell
cd C:\Users\Admin\Downloads\drops\drops-crypto-api
npm run start:dev
```

**–î–æ–∂–¥–∏—Ç–µ—Å—å:** `Nest application successfully started`

---

## –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞

### 5.1 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ health endpoint
–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
http://localhost:3000/health
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è:** `{ "ok": true }`

---

### 5.2 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ OAuth URL
–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
http://localhost:3000/auth/twitch/start
```

**–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –∞–¥—Ä–µ—Å –≤ —Å—Ç—Ä–æ–∫–µ –±—Ä–∞—É–∑–µ—Ä–∞:**
- ‚úÖ **–•–æ—Ä–æ—à–æ**: `client_id=56h1oo23vmfsfcxpaf3gpi08cqlzyb` (–≤–∞—à —Ä–µ–∞–ª—å–Ω—ã–π Client ID)
- ‚ùå **–ü–ª–æ—Ö–æ**: `client_id=your_twitch_client_id_here` (placeholder)

**–ï—Å–ª–∏ –≤—Å—ë –µ—â—ë placeholder:**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `.env` —Å–æ—Ö—Ä–∞–Ω—ë–Ω
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ backend **–ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω** –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è `.env`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ `.env` –Ω–µ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫

---

### 5.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ PowerShell
–í—ã–ø–æ–ª–Ω–∏—Ç–µ:
```powershell
cd C:\Users\Admin\Downloads\drops\drops-crypto-api
node -e "require('dotenv').config(); console.log('TWITCH_CLIENT_ID:', process.env.TWITCH_CLIENT_ID); console.log('TWITCH_CLIENT_SECRET:', process.env.TWITCH_CLIENT_SECRET ? 'SET' : 'NOT SET'); console.log('Is placeholder?', (process.env.TWITCH_CLIENT_ID || '').includes('your_'));"
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è:**
```
TWITCH_CLIENT_ID: 56h1oo23vmfsfcxpaf3gpi08cqlzyb
TWITCH_CLIENT_SECRET: SET
Is placeholder? false
```

---

## –®–∞–≥ 6: –ü—Ä–æ–π–¥–∏—Ç–µ OAuth flow

1. –û—Ç–∫—Ä–æ–π—Ç–µ: `http://localhost:3000/auth/twitch/start`
2. Twitch –ø–æ–∫–∞–∂–µ—Ç —ç–∫—Ä–∞–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
3. –ù–∞–∂–º–∏—Ç–µ **"Authorize"** (—Ä–∞–∑—Ä–µ—à–∏—Ç—å –¥–æ—Å—Ç—É–ø)
4. Twitch –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç –Ω–∞ callback
5. Backend —Å–æ–∑–¥–∞—Å—Ç/–æ–±–Ω–æ–≤–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î

---

## –®–∞–≥ 7: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –û—Ç–∫—Ä–æ–π—Ç–µ Prisma Studio
```powershell
cd C:\Users\Admin\Downloads\drops\drops-crypto-api
npx prisma studio
```

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∞–±–ª–∏—Ü—É User
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É **User**
2. –ù–∞–π–¥–∏—Ç–µ –∑–∞–ø–∏—Å—å —Å `twitchLogin = tiktak6828`
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **twitchUserId**

**–ï—Å–ª–∏ –∑–∞–ø–∏—Å—å –µ—Å—Ç—å** ‚Üí OAuth –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ! ‚úÖ

**–ï—Å–ª–∏ –∑–∞–ø–∏—Å–∏ –Ω–µ—Ç** ‚Üí –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
- Redirect URI –≤ Twitch Console —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å `.env`
- Client Secret –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- Backend –∑–∞–ø—É—â–µ–Ω –∏ –Ω–µ—Ç –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏

---

## ‚ùå –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: "invalid client"
**–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ–≤–µ—Ä–Ω—ã–π Client ID –∏–ª–∏ Secret

**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `.env` —Ñ–∞–π–ª
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Client ID –∏ Secret —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ (–±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤)
3. –ï—Å–ª–∏ Secret —Å–∫—Ä—ã—Ç ‚Äî —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –≤ Twitch Console

---

### –û—à–∏–±–∫–∞: "redirect_uri_mismatch"
**–ü—Ä–∏—á–∏–Ω–∞**: Redirect URI –≤ Twitch Console –∏ `.env` –æ—Ç–ª–∏—á–∞—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Twitch Console ‚Üí OAuth Redirect URLs
2. –î–æ–ª–∂–Ω–æ –±—ã—Ç—å **—Ç–æ—á–Ω–æ**: `http://localhost:3000/auth/twitch/callback`
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `.env`: `TWITCH_REDIRECT_URI=http://localhost:3000/auth/twitch/callback`
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Redirect URL **–¥–æ–±–∞–≤–ª–µ–Ω** –≤ —Å–ø–∏—Å–æ–∫ (–Ω–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞ "–î–æ–±–∞–≤–∏—Ç—å")

---

### Backend –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ `.env` –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–µ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –≤ `.env`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ backend –ø–æ—Å–ª–µ –ª—é–±—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π `.env`

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç

- [ ] Client Secret –ø–æ–ª—É—á–µ–Ω –∏–∑ Twitch Console
- [ ] `.env` —Ñ–∞–π–ª –æ–±–Ω–æ–≤–ª—ë–Ω —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
- [ ] –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å—Ç—Ä–æ–∫–∞—Ö
- [ ] Backend –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è `.env`
- [ ] `/health` –æ—Ç–≤–µ—á–∞–µ—Ç `{ "ok": true }`
- [ ] `/auth/twitch/start` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π Client ID –≤ URL
- [ ] OAuth flow –∑–∞–ø—É—â–µ–Ω –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞
- [ ] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω –≤ –ë–î (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ Prisma Studio)
- [ ] `twitchUserId` —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω

---

**–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å `twitchUserId` –≤ `ADMIN_TWITCH_IDS`!** üöÄ
