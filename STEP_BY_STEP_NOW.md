# üéØ –ü–û–®–ê–ì–û–í–ê–Ø –ò–ù–°–¢–†–£–ö–¶–ò–Ø - –í–´–ü–û–õ–ù–Ø–ô–¢–ï –°–ï–ô–ß–ê–°

## –®–∞–≥ 1: –£–∑–Ω–∞—Ç—å twitchUserId –∏ –ø—Ä–æ–ø–∏—Å–∞—Ç—å ADMIN_TWITCH_IDS

### 1.1 –ó–∞–ø—É—Å—Ç–∏—Ç—å Prisma Studio

```powershell
cd C:\Users\Admin\Downloads\drops\drops-crypto-api
npx prisma studio
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è**: –û—Ç–∫—Ä–æ–µ—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä –Ω–∞ `http://localhost:5555`

### 1.2 –ù–∞–π—Ç–∏ –≤–∞—à twitchUserId

1. –í Prisma Studio –æ—Ç–∫—Ä–æ–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É **User**
2. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à –∞–∫–∫–∞—É–Ω—Ç (–ø–æ `twitchLogin`)
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—è **twitchUserId**

### 1.3 –î–æ–±–∞–≤–∏—Ç—å –≤ .env

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª:
```
C:\Users\Admin\Downloads\drops\drops-crypto-api\.env
```

**–î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É** (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à twitchUserId):
```env
ADMIN_TWITCH_IDS=123456789
```

**–ï—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–æ–≤:**
```env
ADMIN_TWITCH_IDS=123456789,987654321
```

**–ü—Ä–∏–º–µ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ .env:**
```env
DATABASE_URL=postgresql://drops:drops@localhost:5432/drops
REDIS_URL=redis://localhost:6379
TWITCH_CLIENT_ID=your_client_id
TWITCH_CLIENT_SECRET=your_secret
JWT_SECRET=supersecret
PUBLIC_BASE_URL=https://xxxxx.ngrok-free.app
TWITCH_REDIRECT_URI=https://xxxxx.ngrok-free.app/auth/twitch/callback
APP_DEEPLINK_SCHEME=dropscrypto
ADMIN_TWITCH_IDS=123456789
```

---

## –®–∞–≥ 2: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å backend

### 2.1 –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—É—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å (–µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω)

–í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –≥–¥–µ —Ä–∞–±–æ—Ç–∞–µ—Ç backend –Ω–∞–∂–º–∏—Ç–µ: **Ctrl + C**

### 2.2 –ó–∞–ø—É—Å—Ç–∏—Ç—å backend –∑–∞–Ω–æ–≤–æ

```powershell
cd C:\Users\Admin\Downloads\drops\drops-crypto-api
npm run start:dev
```

**–î–æ–∂–¥–∏—Ç–µ—Å—å**: `Nest application successfully started on http://localhost:3000`

**–í–ê–ñ–ù–û**: .env –ø–µ—Ä–µ—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ, –ø–æ—ç—Ç–æ–º—É –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω!

---

## –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Admin Guard (–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Ç–æ—á–∫–∞)

### 3.1 –ü—Ä–æ–≤–µ—Ä–∏—Ç—å /health

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
http://localhost:3000/health
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è**: `{ "ok": true }`

### 3.2 –ü–æ–ª—É—á–∏—Ç—å JWT —Ç–æ–∫–µ–Ω

**–í–∞—Ä–∏–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ OAuth (Twitch)**
1. –û—Ç–∫—Ä–æ–π—Ç–µ: `http://localhost:3000/auth/twitch/start`
2. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω –∏–∑ redirect URL –∏–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–í–∞—Ä–∏–∞–Ω—Ç B: –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω —É–∂–µ –µ—Å—Ç—å**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π JWT —Ç–æ–∫–µ–Ω

### 3.3 –ü—Ä–æ–≤–µ—Ä–∏—Ç—å /admin/claims

**–í PowerShell:**

```powershell
# –ó–∞–º–µ–Ω–∏—Ç–µ –í–ê–®_JWT –Ω–∞ –≤–∞—à —Ç–æ–∫–µ–Ω
$token = "–í–ê–®_JWT"
$headers = @{ Authorization = "Bearer $token" }
Invoke-RestMethod -Uri http://localhost:3000/admin/claims -Headers $headers
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è:**

‚úÖ **–ï—Å–ª–∏ twitchUserId –≤ ADMIN_TWITCH_IDS:**
- –°—Ç–∞—Ç—É—Å: `200 OK`
- –û—Ç–≤–µ—Ç: –ú–∞—Å—Å–∏–≤ claims (–≤–æ–∑–º–æ–∂–Ω–æ –ø—É—Å—Ç–æ–π `[]`)

‚ùå **–ï—Å–ª–∏ twitchUserId –ù–ï –≤ ADMIN_TWITCH_IDS:**
- –°—Ç–∞—Ç—É—Å: `403 Forbidden`
- –°–æ–æ–±—â–µ–Ω–∏–µ: `"Access denied. Admin privileges required."`

**–≠—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ AdminGuard —Ä–∞–±–æ—Ç–∞–µ—Ç!**

---

## –®–∞–≥ 4: –ó–∞–ø—É—Å–∫ –º–æ–±–∏–ª–∫–∏ –Ω–∞ Android Studio Emulator

### 4.1 –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —ç–º—É–ª—è—Ç–æ—Ä –∑–∞–ø—É—â–µ–Ω

1. –û—Ç–∫—Ä–æ–π—Ç–µ **Android Studio**
2. **Device Manager** ‚Üí **Play** (–∑–∞–ø—É—Å—Ç–∏—Ç—å —ç–º—É–ª—è—Ç–æ—Ä)
3. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≥—Ä—É–∑–∫–∏ Android

### 4.2 –ó–∞–ø—É—Å—Ç–∏—Ç—å Expo

```powershell
cd C:\Users\Admin\Downloads\drops\drops-crypto-app
npm start
```

**–í Metro Bundler:**
- –ù–∞–∂–º–∏—Ç–µ **`a`** (–¥–ª—è Android)
- –ò–ª–∏ **`i`** (–¥–ª—è iOS, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

**–û–∂–∏–¥–∞–µ—Ç—Å—è**: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –Ω–∞ —ç–º—É–ª—è—Ç–æ—Ä–µ

### 4.3 –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ç—å (–≤–∞–∂–Ω–æ!)

**–í —ç–º—É–ª—è—Ç–æ—Ä–µ –æ—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä** (Chrome –∏–ª–∏ –¥—Ä—É–≥–æ–π) –∏ –≤–≤–µ–¥–∏—Ç–µ:
```
http://10.0.2.2:3000/health
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è**: –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å `{ "ok": true }`

‚úÖ **–ï—Å–ª–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è** ‚Üí –º–æ–±–∏–ª–∫–∞ —Å–º–æ–∂–µ—Ç –¥–æ—Å—Ç—É—á–∞—Ç—å—Å—è –¥–æ API
‚ùå **–ï—Å–ª–∏ –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è** ‚Üí –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ backend –∑–∞–ø—É—â–µ–Ω –Ω–∞ `localhost:3000`

---

## –®–∞–≥ 5: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç-—Å—Ü–µ–Ω–∞—Ä–∏–π

### 5.1 Streamers
- –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∫–ª–∞–¥–∫—É **"–°—Ç—Ä–∏–º–µ—Ä—ã"**
- **–û–∂–∏–¥–∞–µ—Ç—Å—è**: –°–ø–∏—Å–æ–∫ —Å—Ç—Ä–∏–º–µ—Ä–æ–≤ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è ‚úÖ

### 5.2 Prizes
- –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∫–ª–∞–¥–∫—É **"–ü—Ä–∏–∑—ã"**
- **–û–∂–∏–¥–∞–µ—Ç—Å—è**: –°–ø–∏—Å–æ–∫ –ø—Ä–∏–∑–æ–≤ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è ‚úÖ

### 5.3 Profile - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞
1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∫–ª–∞–¥–∫—É **"–ü—Ä–æ—Ñ–∏–ª—å"**
2. –í–≤–µ–¥–∏—Ç–µ EVM –∞–¥—Ä–µ—Å: `0x1234567890123456789012345678901234567890`
3. –ù–∞–∂–º–∏—Ç–µ **"–î–æ–±–∞–≤–∏—Ç—å –∫–æ—à–µ–ª—ë–∫"**
4. **–û–∂–∏–¥–∞–µ—Ç—Å—è**: –ö–æ—à–µ–ª—ë–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω ‚úÖ

### 5.4 Claim Prize
1. –í–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ **"–ü—Ä–∏–∑—ã"**
2. –ù–∞–∂–º–∏—Ç–µ **"–ü–æ–ª—É—á–∏—Ç—å"** –Ω–∞ –ª—é–±–æ–º –ø—Ä–∏–∑–µ
3. **–û–∂–∏–¥–∞–µ—Ç—Å—è**: Claim —Å–æ–∑–¥–∞–Ω —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º PENDING ‚úÖ

### 5.5 My Claims/Prizes
1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∫–ª–∞–¥–∫—É **"–ú–æ–∏ –ø—Ä–∏–∑—ã"**
2. **–û–∂–∏–¥–∞–µ—Ç—Å—è**: –í–∞—à claim –≤–∏–¥–µ–Ω ‚úÖ
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã (–í—Å–µ / –í –æ–∂–∏–¥–∞–Ω–∏–∏ / –£—Å–ø–µ—à–Ω–æ / –û—à–∏–±–∫–∞)
4. **–û–∂–∏–¥–∞–µ—Ç—Å—è**: –§–∏–ª—å—Ç—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç ‚úÖ

### 5.6 Admin –º–µ–Ω—è–µ—Ç —Å—Ç–∞—Ç—É—Å

**–í PowerShell (–∏–ª–∏ Postman):**

```powershell
# –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ claims
$token = "–í–ê–®_JWT_–ê–î–ú–ò–ù–ê"
$headers = @{ Authorization = "Bearer $token" }
$claims = Invoke-RestMethod -Uri http://localhost:3000/admin/claims -Headers $headers

# –ù–∞–π—Ç–∏ ID –≤–∞—à–µ–≥–æ claim
$claimId = $claims[0].id  # –∏–ª–∏ —É–∫–∞–∂–∏—Ç–µ –≤—Ä—É—á–Ω—É—é

# –ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å –Ω–∞ PROCESSING
Invoke-RestMethod -Method PUT -Uri "http://localhost:3000/admin/claims/$claimId/mark-processing" -Headers $headers

# –ò–ª–∏ –Ω–∞ SUCCESS
Invoke-RestMethod -Method PUT -Uri "http://localhost:3000/admin/claims/$claimId/mark-success" -Headers $headers

# –ò–ª–∏ –Ω–∞ FAILED
Invoke-RestMethod -Method PUT -Uri "http://localhost:3000/admin/claims/$claimId/mark-failed" -Headers $headers -Body (@{ error = "Test error" } | ConvertTo-Json) -ContentType "application/json"
```

### 5.7 Mobile –≤–∏–¥–∏—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

1. –í –º–æ–±–∏–ª–∫–µ –Ω–∞ —ç–∫—Ä–∞–Ω–µ **"–ú–æ–∏ –ø—Ä–∏–∑—ã"**
2. **–û–±–Ω–æ–≤–∏—Ç–µ** (pull-to-refresh –∏–ª–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —ç–∫—Ä–∞–Ω)
3. **–û–∂–∏–¥–∞–µ—Ç—Å—è**: –°—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω–∏–ª—Å—è ‚úÖ

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –Ω—é–∞–Ω—Å—ã

### Twitch OAuth –Ω–∞ —ç–º—É–ª—è—Ç–æ—Ä–µ

**–ü—Ä–æ–±–ª–µ–º–∞**: Expo Go –º–æ–∂–µ—Ç –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–∏–ø–ª–∏–Ω–∫–∏ `dropscrypto://...`

**–†–µ—à–µ–Ω–∏–µ:**
- **–í–∞—Ä–∏–∞–Ω—Ç A**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Expo Dev Client
  ```powershell
  cd drops-crypto-app
  npx expo run:android
  ```

- **–í–∞—Ä–∏–∞–Ω—Ç B**: –î–ª—è —Ç–µ—Å—Ç–∞ –±–µ–∑ OAuth –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π JWT —Ç–æ–∫–µ–Ω
  - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω
  - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ –º–æ–±–∏–ª–∫–µ (–µ—Å–ª–∏ –µ—Å—Ç—å UI –¥–ª—è –≤–≤–æ–¥–∞ —Ç–æ–∫–µ–Ω–∞)

### –¢–µ—Å—Ç–æ–≤—ã–π —Ç–æ–∫–µ–Ω

–ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å JWT —Ç–æ–∫–µ–Ω –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ç–µ—Å—Ç–∞, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π –±–µ–∑ OAuth.

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

- [ ] –®–∞–≥ 1: Prisma Studio –∑–∞–ø—É—â–µ–Ω, twitchUserId –Ω–∞–π–¥–µ–Ω, ADMIN_TWITCH_IDS –ø—Ä–æ–ø–∏—Å–∞–Ω
- [ ] –®–∞–≥ 2: Backend –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
- [ ] –®–∞–≥ 3: /admin/claims —Ä–∞–±–æ—Ç–∞–µ—Ç (200 –¥–ª—è –∞–¥–º–∏–Ω–∞, 403 –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ)
- [ ] –®–∞–≥ 4: –≠–º—É–ª—è—Ç–æ—Ä –∑–∞–ø—É—â–µ–Ω, Expo –∑–∞–ø—É—â–µ–Ω, /health –¥–æ—Å—Ç—É–ø–µ–Ω –≤ —ç–º—É–ª—è—Ç–æ—Ä–µ
- [ ] –®–∞–≥ 5: –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã (Streamers, Prizes, Profile, Claim, My Claims, Admin status change)

---

## üéØ –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥

**–°–¥–µ–ª–∞–π—Ç–µ –®–∞–≥ 1 –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å:**
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Prisma Studio
2. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à twitchUserId
3. –î–æ–±–∞–≤—å—Ç–µ –≤ .env: `ADMIN_TWITCH_IDS=–≤–∞—à_id`

**–ù–∞–ø–∏—à–∏—Ç–µ:**
- ‚úÖ –ù–∞—à–µ–ª twitchUserId –∏ –ø—Ä–æ–ø–∏—Å–∞–ª ADMIN_TWITCH_IDS
- ‚ùå –ù–µ –Ω–∞—à–µ–ª / –ø—Ä–æ–±–ª–µ–º–∞

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –¥–∞–º —Ç–æ—á–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ /admin/claims –∏ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ claim!
